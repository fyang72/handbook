---
title: "monkeyPK"
author: "Feng Yang"
date: "December 5, 2017"
output: 
  word_document:
          reference_docx: ./common/word-styles-reference-02.docx
bibliography: ./common/RepResRef.bib          
---


```{r setup, include=FALSE, message=FALSE}
#  http://rmarkdown.rstudio.com/articles_docx.html

knitr::opts_chunk$set(echo = TRUE)

mkdata = read_csv(file=paste0(HOME, "./data/monkey_tdata.csv"), na=".") 
                                 

mkdata[is.na(mkdata)]<-"."
mkdata[mkdata==""]<-"."

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


## Including Plots

You can also embed plots, for example:

```{r mkdata, echo=FALSE}
 
tdata = mkdata

x = tick_label(x=tdata$TIME, xmin=0, xmax=100, major.tick=7, minor.tick=7, log=FALSE)
y = tick_label(x=tdata$DV, xmin=1E-2, xmax=1E+3,  log=TRUE) 

fig = tdata %>% filter(DV!=0, DV!=0.039) %>%
  ggplot(aes(x=as_numeric(TIME), y=as_numeric(DV), group=USUBJID, col=ARMA)) + 
  geom_point() +  geom_line() +  #scale_y_log10()  + 
  xlab("Time (day)") + 
  ylab("Concentration (mg/L)") + 
  base_theme(font.size=14) + 
  scale_x_continuous(breaks=x$breaks, label=x$labels) + 
  scale_y_log10(breaks=y$breaks, label=y$labels) + 
  
  coord_cartesian(xlim = range(tdata$TIME, na.rm=TRUE)) + 
  coord_cartesian(ylim = range(tdata$DV, na.rm=TRUE)+ 1E-2) + 
  
  theme(#legend.title=element_text("EXSEQ"), 
        #legend.position=c(0.95, 0.86), 
        panel.grid.minor= element_line(colour = "gray97",size=0.1),
        panel.grid.major= element_line(colour = "gray97",size=0.1),
        panel.spacing = unit(0.2, "lines"), 
        panel.border=element_rect(colour="black", fill=NA), 
        strip.background = element_blank()   # element_rect(colour=NA, fill=NA),
  ) #+scale_color_gradient(low="grey", high="black")


FIGURE_ALL[["monkey_pk"]] = fig
fig

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.




When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

 

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r df, message=FALSE, echo=FALSE}
library(dplyr)
# extract a subset of the mtcars data
df <- mtcars %>%
    mutate(make_model = row.names(mtcars)) %>%
    filter(cyl == 4) %>%    
    select(make_model, mpg, wt) %>%
    mutate(wt = wt*1000) %>%
    arrange(make_model) 
   

```    

<br>
sfs
f
sf
sf
<br>


```{r knitr-table, message=FALSE, echo=FALSE}
library(knitr)
kable(df) 
 

```

<br>
sfs
f
sf
sf
<br>
Write the bib file
Specify the bibliography file in the front matter
Cite references in markdown format

http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html
In [@Stodden2014], authors mentioned Word tables as one of the
obstacles to effective collaboration.

Include a references section heading at the end of the Rmd script
Format the bibliography style in the styles reference docx file

```{r pander-table, message=FALSE, echo=FALSE}
library(pander)
pander(df)
 

```


violets are <span style="color:blue">blue</span>.

Roses are \textcolor{red}{red}, violets are \textcolor{blue}{blue}.


```{r eval=FALSE}

#```{r results='asis', eval=FALSE}
#Color Format
library(knitr)
library(xtable)

colFmt = function(x,color){
  outputFormat = opts_knit$get("rmarkdown.pandoc.to")
  if(outputFormat == 'latex')
    paste("\\textcolor{",color,"}{",x,"}",sep="")
  else if(outputFormat == 'html')
    paste("<font color='",color,"'>",x,"</font>",sep="")
  else
    x
}

tbl = data.frame(a = letters[1:10], b = 1:10 / 10)
tbl$b = ifelse(tbl$b < 0.5, colFmt(tbl$b, "red"), colFmt(tbl$b, "green"))
print(xtable(tbl), sanitize.text.function = identity)
```



